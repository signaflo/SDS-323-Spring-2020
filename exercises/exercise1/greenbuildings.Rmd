---
title: "greenbuildings"
author: "Crystal Tse"
date: "2/7/2020"
output: html_document
---

```{r echo = FALSE}
library(mosaic)
library(tidyverse)
library(kableExtra)
library(knitr)
grb = read.csv("greenbuildings.csv")
```


```{r echo = FALSE}
#ggplot(data = grb, mapping = aes(group = green_rating, y = median(Rent))+ geom_bar(stat = "identity"))

#ggplot(data = grb)+ geom_bar(green_rating, Rent, fill = as.factor(green_rating), stat= "summary", fun.y = "median")

# try to make a table comparing no filter and size between 200k and 300k square feet median rent, green vs nongreen
# mean age by class

# Below is the table without any filter for size (the same as the guru's analysis)
grb %>% 
  group_by(green_rating) %>% 
  summarize(median_rent = median(Rent, na.rm = TRUE)) %>% kable(col.names = c("Green Rating", "Median Rent"), caption = "Median Rent Overall") %>% kable_styling(full_width = F ,position = "left")

```
Since the building we plan to construct is 250,000 square feet, it would be appropriate to limit our focus to buildings within the relevant range of square footage. Below is the table with only buildings with square footage between 200,000 and 300,000. The difference in median rent for green and non-green is only \$0.84 per square foot, instead of the previous consultation of \$2.60 per square foot.
```{r echo = FALSE}

grb %>% filter(size >= 200000 & size <= 300000) %>% 
  group_by(green_rating) %>% 
  summarize(median_rent = median(Rent, na.rm = TRUE))%>% kable(col.names = c("Green Rating", "Median Rent"), caption = "Median Rent by Relevant Area") %>% kable_styling(full_width = F ,position = "left")
```

Therefore, the actual difference in median rent shows that the revenue generated by the green building is not as strong as the previous report suggests. Instead of 250,000 square feet multiplied by \$2.60 extra in revenue for the green building (\$650,000 per year), the difference in median rent for the relevant square footage more closely represents 250,000 * \$0.84, which is an additional \$210,000 per year, assuming the difference in rent is solely attributed to green buildings. There are other potential confounding factors that could also influence this $0.84 difference in rent, especially if green buildings are inherently correlated with certain attributes.

Filtering further for age, since our building will be newly constructed, it is more relevant to focus on buildings that are less than 10 years old.
```{r echo = FALSE}
grb %>% filter(size >= 200000 & size <= 300000 & age < 10) %>% 
  group_by(green_rating) %>% 
  summarize(median_rent = median(Rent, na.rm = TRUE))%>% kable(col.names = c("Green Rating", "Median Rent"), caption = "Median Rent by Relevant Area and Age") %>% kable_styling(full_width = F ,position = "left")
```
The median rent for non-green buildings is actually much higher than that for green buildings if filtering for both square footage and age. Non-green buildings are shown to have a \$7.26 advantage over green buildings, not accounting for other confounding factors.

The previous report's findings threw out outliers in terms of low occupancy but did not consider the relevant range for the desired building. The focus on newer buildings around 250,000 square feet allows for a more targeted comparison and reveals that simply comparing green and non-green buildings as a whole introduces a host of problems due to the vast range of possible building types.


